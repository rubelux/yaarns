<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
     <title>Shaker Components</title>
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '',
        COLLAPSE_INDEX: true,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
   </head> 

     <div class="header"><h1 class="heading"><a href="#">
          <span>Shaker</span></a></h1>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../">Mojito Documentation</a>
        &#160;&#160;::&#160;&#160;
        <a href="index.html" title="Shaker">Shaker</a>
        &#160;&#160;::&#160;&#160;
        
           <a href="shaker_inlining.html">Inlining Resources</a>
        &#160;&#160;::&#160;&#160;
        
        
        </p>

      </div>
      <div class="content">
   <div class="section" id="shaker-components">
<h1>Shaker Components<a class="headerlink" href="#shaker-components" title="Permalink to this headline">¶</a></h1>
<p>Shaker is comprised of three components that work together in various ways depending on
the environment. This chapter provides an nontechnical overview focusing on
the three components and how they work together.</p>
<div class="section" id="shaker-core">
<span id="shaker-components-core"></span><h2>Shaker Core<a class="headerlink" href="#shaker-core" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/shaker_core.png"><img alt="_images/shaker_core.png" src="_images/shaker_core.png" /></a>
<p>Shaker Core is the foundation of Shaker. It alone has the ability to parse <tt class="docutils literal"><span class="pre">shaker.json</span></tt>
configuration files, compute and resolve rollup dimensions and dependencies, and
ultimately generate rollup metadata.</p>
</div>
<div class="section" id="shaker-compiler">
<span id="shaker-components-compiler"></span><h2>Shaker Compiler<a class="headerlink" href="#shaker-compiler" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/shaker_compiler.png"><img alt="_images/shaker_compiler.png" src="_images/shaker_compiler.png" /></a>
<p>The Shaker Compiler is the build-time component of Shaker. It uses Shaker Core to
generate the metadata and to create the rollups for the application.</p>
<p>Shaker Compiler can be configured for each environment (staging, test, production) in
<tt class="docutils literal"><span class="pre">application.json</span></tt>, and you can also decide what actions to apply to the
rollups (minify, js/css lint, etc). Moreover, you can set what we call <em>deployment tasks</em>,
which allow developers to deploy rollups to different places:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">raw</span></tt> - Deploy the assets without doing rollups. This mode will pick the files
directly from disk (handy for development).</li>
<li><tt class="docutils literal"><span class="pre">local</span></tt> - Compile rollups and output files locally.</li>
<li><tt class="docutils literal"><span class="pre">s3</span></tt> - Compile rollups and upload them to Amazon S3 CDN.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Shaker Compiler has nothing to do with any Cocktails product; it is just a name
of a Shaker internal component.</p>
</div>
</div>
<div class="section" id="shaker-addon-and-shakerhtmlframe">
<span id="shaker-components-addon"></span><h2>Shaker Addon and ShakerHTMLFrame<a class="headerlink" href="#shaker-addon-and-shakerhtmlframe" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/shaker_addon.png"><img alt="_images/shaker_addon.png" src="_images/shaker_addon.png" /></a>
<p>The Shaker Mojito addon is the runtime component of Shaker. It reads the metadata
generated by the Shaker Compiler, and subsequently, manages assets within the application,
picking the correct rollup based on the current environment.</p>
<p>The ShakerHTMLFrame is a copy of the Mojito HTMLFrameMojit, but it additionally includes
the addon and executes Shaker automatically.</p>
</div>
<div class="section" id="putting-the-pieces-together">
<span id="shaker-components-together"></span><h2>Putting The Pieces Together<a class="headerlink" href="#putting-the-pieces-together" title="Permalink to this headline">¶</a></h2>
<p>This is how all the components work together:</p>
<div class="section" id="build-time">
<span id="components-together-build-time"></span><h3>Build time<a class="headerlink" href="#build-time" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>The <tt class="docutils literal"><span class="pre">shaker</span></tt> command gets executed, invoking Shaker Compiler.</li>
<li>Shaker Compiler gets the application configuration and calls Shaker Core.</li>
<li>Shaker Core analyzes all the application resources and returns a metadata object with
all the information necessary to create the rollups.</li>
<li>Shaker Compiler takes the previously generated metadata, generates the minified
precomputed rollups, and outputs them as files or to a CDN.</li>
<li>Shaker Compiler outputs a new metadata file which will be picked up at runtime to
use the correct rollup based on the context.</li>
</ol>
</div>
<div class="section" id="runtime">
<span id="components-together-runtime"></span><h3>Runtime<a class="headerlink" href="#runtime" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>The Mojito server automatically selects the generated metadata file.</li>
<li>When a request arrives, Mojito computes everything normally until it reaches the
ShakerHTMLFrame. Then the Shaker Addon gets executed.</li>
<li>Shaker Addon checks the current context and the executed mojits and chooses from the
metadata the proper rollup to include in the page, overriding the required default
Mojito assets.</li>
<li>All resources are deployed transparently to the developer.</li>
</ol>
</div>
</div>
</div>

   </div>
